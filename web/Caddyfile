# Caddyfile - THE FIX
# The global options block MUST be the very first thing in the file.
{
    # Remove this block for production to get a real certificate.
    acme_ca https://acme-staging-v02.api.letsencrypt.org/directory
}

# Then, define your site.
intelvis.ai {
    # Route /api/* to the backend service.
    # This is processed first.
    route /api/* {
        reverse_proxy backend:3001
    }

    # Route everything else to the frontend service.
    # This is the fallback.
    route {
        reverse_proxy frontend:3000
    }
}